/*!CK:1821722948!*//*1459132544,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["pAEbw"]); }

__d('ChatPhotoUploader.react',['cx','fbt','ix','Promise','Bootloader','Image.react','InlineBlock.react','Link.react','MercuryConfig','React','ReactDOM','SubscriptionsHandler','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('React').createClass({displayName:'ChatPhotoUploader',propTypes:{actionURI:k.string,allowCrossPage:k.bool,customUI:k.bool,disabled:k.bool,imageClassName:k.string,imagesOnly:k.bool,linkClassName:k.string,onSubmit:k.func,onAllUploadsComplete:k.func,onLastUploadFail:k.func,onLastUploadCancel:k.func,onMount:k.func,onUploadError:k.func},getDefaultProps:function(){return {actionURI:c('MercuryConfig').upload_url,allowCrossPage:true,costomUI:false,disabled:false,imageClassName:"_509w",imagesOnly:true,linkClassName:'',onSubmit:c('emptyFunction'),onAllUploadsComplete:c('emptyFunction'),onLastUploadFail:c('emptyFunction'),onLastUploadCancel:c('emptyFunction')};},shouldComponentUpdate:function(m,n){return m.actionURI!=this.props.actionURI||m.disabled!==this.props.disabled;},componentDidMount:function(){if(this.props.onMount)this.props.onMount(this);},componentDidUpdate:function(m,n){if(this._uploader)this._uploader.setAllowCrossPage(this.props.allowCrossPage);},componentWillUnmount:function(){if(!this.isUploading()||!this.props.allowCrossPage)this._cleanup();},render:function(){var m=this.props.imagesOnly?i._("Add Photos"):i._("Add Files"),n=c('joinClasses')("_4q61"+(!this.props.customUI?' '+"_5f0v":'')+(!this.props.customUI?' '+"_509v":''),this.props.linkClassName);return (c('React').createElement('form',{action:this.props.actionURI,className:"_vzk",title:m,method:'post',onClick:function(o){o.stopPropagation();if(this.props.disabled)o.preventDefault();}.bind(this),ref:'form'},c('React').createElement('input',{type:'hidden',name:'attach_id',ref:'attachID'}),c('React').createElement('input',{type:'hidden',name:'images_only',value:this.props.imagesOnly}),c('React').createElement(c('InlineBlock.react'),{onClick:this._bootloadChatAutoSendPhotoUploader,className:c('joinClasses')(this.props.className,"_m _4q60 _3rzn")},c('React').createElement('input',{disabled:this.props.disabled,type:'file',className:"_n _2__f",name:'attachment[]',multiple:'true',accept:this.props.imagesOnly?'image/*':'*',ref:'input',title:m}),c('React').createElement(c('Link.react'),{className:n,tabIndex:-1},c('React').createElement('i',{className:this.props.imageClassName,alt:i._("Camera")})))));},_handleSubmit:function(m,n){this.props.onSubmit(m,n);},_handleAllUploadsCompleted:function(m,n){this.props.onAllUploadsComplete(m,n);if(!this.isMounted())this._cleanup();},_handleLastUploadFailed:function(m,n){this.props.onLastUploadFail(m,n);if(!this.isMounted())this._cleanup();},_handleLastUploadCanceled:function(m,n){this.props.onLastUploadCancel(m,n);if(!this.isMounted())this._cleanup();},_handleUploadError:function(m,n){this.props.onUploadError(n);if(!this.isMounted())this._cleanup();},isUploading:function(){return (this._uploader&&this._uploader.isUploading()||this._uploaderPromiseIsResolving);},_bootloadChatAutoSendPhotoUploader:function(){if(!this._uploaderPromise){this._uploaderPromiseIsResolving=true;this._uploaderPromise=new (c('Promise'))(function(m){c('Bootloader').loadModules(["ChatAutoSendPhotoUploader"],function(n){this._uploaderPromiseIsResolving=false;this._uploader=new n(c('ReactDOM').findDOMNode(this.refs.form),c('ReactDOM').findDOMNode(this.refs.input),c('ReactDOM').findDOMNode(this.refs.attachID),c('MercuryConfig').msgr_region);this._uploader.setAllowCrossPage(this.props.allowCrossPage);this._subscriptions=new (c('SubscriptionsHandler'))();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled),this._uploader.subscribe('file-upload-error',this._handleUploadError));m(this._uploader);}.bind(this));}.bind(this));}return this._uploaderPromise;},uploadFiles:function(m){this._bootloadChatAutoSendPhotoUploader().then(function(n){n.uploadFiles(m);});},uploadURL:function(m){this._bootloadChatAutoSendPhotoUploader().then(function(n){n.uploadURL(m);});},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();}});f.exports=l;},null);
__d("XStickerReplyNUXController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/tooltip\/",{});},null);