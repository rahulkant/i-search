/*!CK:160444722!*//*1459137497,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["ctEbE"]); }

__d('MessengerTabIndices',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={NEW_MESSAGE_TOKENIZER:9998,COMPOSER_INPUT:9999};f.exports=h;},null);
__d('MessengerScrollableTypeaheadView.react',['MessengerScrollableArea.react','MessengerTypeaheadUtils','MessengerTypeaheadView.react','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').createClass({displayName:'MessengerScrollableTypeaheadView',mixins:[c('ReactComponentWithPureRenderMixin')],render:function(){var i=this.props,j=i.className,k=i.width,l=babelHelpers.objectWithoutProperties(i,['className','width']);return (c('React').createElement(c('MessengerScrollableArea.react'),{className:j,ref:'scrollable',width:k},c('React').createElement(c('MessengerTypeaheadView.react'),babelHelpers['extends']({},l,{onScrollIntoView:this._handleScrollIntoView}))));},_handleScrollIntoView:function(i){c('MessengerTypeaheadUtils').scrollEntryIntoView(i,this.refs.scrollable);}});f.exports=h;},null);
__d('MessengerTokenizer.react',['cx','invariant','AbstractTokenizer.react','immutable','Keys','React','SearchableEntry','MessengerScrollableTypeaheadView.react','MessengerTypeaheadUtils','ReactComponentWithPureRenderMixin','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=30,l=100,m=c('React').createClass({displayName:'MessengerTokenizer',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{autoFocus:j.bool,className:j.string,context:j.object,entries:j.instanceOf(c('immutable').List).isRequired,excludeGroups:j.bool,extraRendererProps:j.object,hasHoverState:j.bool,hideViewWithEntries:j.bool,onAddEntryAttempt:j.func.isRequired,onEntriesFound:j.func,onRemoveEntryAttempt:j.func.isRequired,onReorderEntryAttempt:j.func,originalEntryIDs:j.instanceOf(c('immutable').Set),placeholder:j.string,searchSource:j.object.isRequired,tabIndex:j.number,useLayer:j.bool,viewer:j.string.isRequired},getDefaultProps:function(){return {excludeGroups:false,hideViewWithEntries:true};},getInitialState:function(){return {isLoading:false,isLoaded:false,queryString:''};},componentDidMount:function(){if(this.props.autoFocus)this.focusInput();},render:function(){return (c('React').createElement('div',{className:c('joinClasses')(this.props.className,"_14-7")},c('React').createElement(c('AbstractTokenizer.react'),{autoHighlight:this.props.hasHoverState,context:this.props.context,entries:this.props.entries.toArray(),excludeTokenEntries:!!this.state.queryString,hideViewWithEntries:this.props.hideViewWithEntries,onAddEntryAttempt:this._handleAddEntryAttempt,onEntriesFound:this.props.onEntriesFound,onQueryStringChange:this._handleQueryStringChange,onRemoveEntryAttempt:this.props.onRemoveEntryAttempt,onReorderEntryAttempt:this.props.onReorderEntryAttempt,placeholder:this.props.placeholder,presenter:{ViewRenderer:c('MessengerScrollableTypeaheadView.react'),TokenRenderer:n,alwaysVisibleOnFocus:(this.state.isLoading||this.state.isLoaded)&&!!this.state.queryString,useLayer:this.props.useLayer,extraRendererProps:babelHelpers['extends']({hasHoverState:this.props.hasHoverState,isLoading:this.state.isLoading,originalEntryIDs:this.props.originalEntryIDs,selectedEntryIDs:c('immutable').Seq(this.props.entries).map(function(o){return o.getUniqueID();}).toSet(),viewer:this.props.viewer},this.props.extraRendererProps),maxEntries:k,sortEntries:this._sortEntries},queryString:this.state.queryString,ref:'tokenizer',searchSource:this.props.searchSource,searchSourceOptions:{onQueryFinished:this._handleQueryFinished,onQueryStarted:this._handleQueryStarted,showDefaultEntries:this.props.showDefaultEntries},showEntriesOnFocus:true,tabIndex:this.props.tabIndex&&this.props.tabIndex.toString()})));},_handleAddEntryAttempt:function(o){this.setState({isLoaded:false,queryString:''});var p=o.getUniqueID();if(this.props.entries.some(function(q){return (q.getUniqueID()===p);})){this.props.onRemoveEntryAttempt(o);return;}if(this.props.originalEntryIDs&&this.props.originalEntryIDs.contains(p))return;this.props.onAddEntryAttempt(o);},_sortEntries:function(o){if(this.props.entries.size||this.props.excludeGroups)return c('MessengerTypeaheadUtils').sortEntriesWithoutGroupsOrViewer(o,this.props.viewer);return c('MessengerTypeaheadUtils').sortEntries(o,this.state.queryString);},focusInput:function(){setTimeout(function(){this.refs.tokenizer&&this.refs.tokenizer.focusInput();}.bind(this));},_handleQueryStarted:function(o){if(o===this.state.queryString)this.setState({isLoading:true});},_handleQueryFinished:function(o){if(o===this.state.queryString)this.setState({isLoaded:true,isLoading:false});},_handleQueryStringChange:function(event){!(event.target instanceof HTMLInputElement)?i(0):void 0;this.setState({isLoaded:false,queryString:event.target.value});}}),n=c('React').createClass({displayName:'MessengerTokenizerToken',propTypes:{className:j.string,entry:j.instanceOf(c('SearchableEntry')),index:j.number,label:j.string.isRequired,onRemove:j.func},render:function(){return (c('React').createElement('span',{className:c('joinClasses')(this.props.className,"_14-8"),label:null,onClick:this._handleClick,onKeyDown:this._handleKeyDown,tabIndex:this.props.index+l},c('React').createElement('span',{'aria-label':this.props.label,title:this.props.label,className:"_14-9"},this.props.label)));},_handleClick:function(event){event.stopPropagation();},_handleKeyDown:function(event){if(event.keyCode===c('Keys').BACKSPACE){event.preventDefault();this.props.onRemove&&this.props.onRemove(this.props.entry);}}});f.exports=m;},null);
__d('MessengerComposeViewHeader.react',['cx','fbt','immutable','MessengerSearchSource','MessengerTabIndices','MessengerTokenizer.react','ReactComponentWithPureRenderMixin','React','clearImmediate','joinClasses','setImmediate'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=320,l=c('React').createClass({displayName:'MessengerComposeViewHeader',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{onAddRecipient:j.func.isRequired,onRemoveRecipient:j.func.isRequired,onResize:j.func.isRequired,recipients:j.instanceOf(c('immutable').List).isRequired,viewer:j.string.isRequired},_timer:null,getInitialState:function(){return {tokenizerContext:null};},componentDidMount:function(){this._focusTokenizer();this.setState({tokenizerContext:this.refs.tokenizerContext});},componentDidUpdate:function(m){if(this.props.recipients!==m.recipients)this.props.onResize();},componentWillUnmount:function(){this._timer&&c('clearImmediate')(this._timer);},render:function(){return (c('React').createElement('div',{className:c('joinClasses')("_2y8y _5l-3",this.props.className)},c('React').createElement('div',{className:"_2y8z"},i._("To:")),c('React').createElement('div',null,c('React').createElement(c('MessengerTokenizer.react'),{className:"_2y8-",context:this.state.tokenizerContext,entries:this.props.recipients,extraRendererProps:{className:"_2y8_",width:k},hasHoverState:true,onAddEntryAttempt:this.props.onAddRecipient,onRemoveEntryAttempt:this.props.onRemoveRecipient,placeholder:i._("Type the name of a person or group"),ref:'tokenizer',searchSource:c('MessengerSearchSource').getForFBID(this.props.viewer),tabIndex:c('MessengerTabIndices').NEW_MESSAGE_TOKENIZER,useLayer:true,viewer:this.props.viewer}),c('React').createElement('div',{ref:'tokenizerContext'}))));},_focusTokenizer:function(){this._timer=c('setImmediate')(function(){this.refs.tokenizer&&this.refs.tokenizer.focusInput();}.bind(this));}});f.exports=l;},null);
__d('MessengerForwardAttachmentDialog.react',['ix','cx','fbt','AsyncRequest','CurrentUser','Image.react','immutable','LayerFadeOnHide','MessengerComposeViewHeader.react','MessengerDialog.react','MessengerDialogBody.react','MessengerDialogButton.react','MessengerDialogCancelButton.react','MessengerDialogFooter.react','MessengerDialogHeader.react','MessengerDialogTitle.react','MessengerSpinner.react','React','XMessagingForwardAttachmentController','emptyFunction','fbglyph'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('React').createClass({displayName:'MessengerForwardAttachmentDialog',propTypes:{attachmentID:k.string.isRequired,onClose:k.func,shown:k.bool.isRequired,title:k.string.isRequired},getInitialState:function(){return {recipients:c('immutable').List(),sendError:null,sending:false,startingThreadingID:Date.now()};},render:function(){var m=j._("Send"),n;if(this.state.sending){n=c('React').createElement('div',null,c('React').createElement(c('MessengerSpinner.react'),null),c('React').createElement('span',{className:"_1e1n _3-99"},j._("Sending")));}else if(this.state.sendError){var o=h("\/images\/assets_DO_NOT_HARDCODE\/fb_glyphs\/caution-solid_16_bluegray-40.png");n=c('React').createElement('div',{className:"_1e1n"},c('React').createElement(c('Image.react'),{src:o}),c('React').createElement('span',{className:"_3-99"},this.state.sendError));}return (c('React').createElement(c('MessengerDialog.react'),{shown:this.props.shown,behaviors:{LayerFadeOnHide:c('LayerFadeOnHide')},onToggle:this._handleToggle,width:560},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,this.props.title)),c('React').createElement(c('MessengerDialogBody.react'),null,c('React').createElement(c('MessengerComposeViewHeader.react'),{className:"_1e1o",onAddRecipient:this._handleAddRecipient,onRemoveRecipient:this._handleRemoveRecipient,onResize:c('emptyFunction'),recipients:this.state.recipients,viewer:c('CurrentUser').getID()})),c('React').createElement(c('MessengerDialogFooter.react'),{leftContent:n},c('React').createElement(c('MessengerDialogCancelButton.react'),{onClick:this.props.onClose}),c('React').createElement(c('MessengerDialogButton.react'),{action:'confirm',disabled:!this.state.recipients.size||this.state.sending,label:m,onClick:this._handleSubmit,type:'primary'}))));},_handleAddRecipient:function(m){this.setState({recipients:this.state.recipients.push(m)});},_handleRemoveRecipient:function(m){var n=this.state.recipients;this.setState({recipients:n['delete'](n.indexOf(m))});},_handleSubmit:function(){var m={},n=this.state.startingThreadingID;this.state.recipients.forEach(function(p){m[n++]=p.getUniqueID();});var o=c('XMessagingForwardAttachmentController').getURIBuilder().getURI();new (c('AsyncRequest'))(o).setMethod('POST').setHandler(this._handleSubmitResponse).setData({attachment_id:this.props.attachmentID,recipient_map:m}).send();this.setState({sending:true,sendError:null});},_handleSubmitResponse:function(m){if(m.payload.success){this.props.onClose&&this.props.onClose();this.setState({recipients:c('immutable').List(),sending:false,startingThreadID:Date.now()});return;}this.setState({sending:false,sendError:m.payload.error});},_handleToggle:function(m){if(!m)this.props.onClose&&this.props.onClose();}});f.exports=l;},null);
__d("XForwardingNUXSeenController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/chat\/forwarding_nux_seen\/",{});},null);
__d('MessagingForwardingButtonNUX.react',['AsyncRequest','ChatConfig','React','XForwardingNUXSeenController','XUIAmbientNUX.react'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'MessagingForwardingButtonNUX',propTypes:{contextRef:h.func.isRequired},getInitialState:function(){return {showNUX:!c('ChatConfig').get('seen_forwarding_nux')};},_onClose:function(){if(!this.state.showNUX)return;c('ChatConfig').set('seen_forwarding_nux',true);new (c('AsyncRequest'))(c('XForwardingNUXSeenController').getURIBuilder().getURI()).send();this.setState({showNUX:false});},render:function(){return (c('React').createElement(c('XUIAmbientNUX.react'),{contextRef:this.props.contextRef,onCloseButtonClick:this._onClose,position:'left',width:'auto',shown:this.state.showNUX},this.props.children));},close:function(){this._onClose();}});f.exports=i;},null);