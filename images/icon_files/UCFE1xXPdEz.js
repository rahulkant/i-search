/*!CK:2582548810!*//*1457498962,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["doJiQ"]); }

__d("XMessagingVideoAttachmentController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/mercury\/attachments\/video\/",{video_id:{type:"String",required:true},video_container_id:{type:"String",required:true},width:{type:"Int",required:true},height:{type:"Int",required:true}});},null);
__d('MessagingVideoViewer.react',['cx','fbt','ActorURI','ArbiterMixin','AsyncRequest','CurrentEnvironment','MessagingForwardAttachmentDialog.react','MessagingForwardingButtonNUX.react','MessengerForwardAttachmentDialog.react','React','ReactLayeredComponentMixin','SpotlightViewer','SpotlightViewerBottomBar','SpotlightViewerBottomBarGroup','SpotlightViewerBottomBarLink','SpotlightViewerClose','SpotlightViewport','PageTransitionsRegistrar','PhotoViewerDimensions','XMessagingVideoAttachmentController','Vector','guid'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=200,l=c('React').createClass({displayName:'MessagingVideoViewer',propTypes:{disableForward:j.bool,pageID:j.number,rootClassName:j.string,videoSize:j.instanceOf(c('Vector')).isRequired,videoID:j.string.isRequired,videoURI:j.string.isRequired},mixins:[c('ArbiterMixin'),c('ReactLayeredComponentMixin')],getInitialState:function(){var m=new (c('PhotoViewerDimensions'))({verticalPadding:k});return {dimensions:m.getStageDimensions(this.props.videoSize),loading:true,open:true,showForward:false};},componentWillMount:function(){this._domID=c('guid')();},componentDidMount:function(){this._loadVideoPlayer();c('PageTransitionsRegistrar').registerCompletionCallback(function(){this.close();return true;}.bind(this));},_loadVideoPlayer:function(){var m=c('XMessagingVideoAttachmentController').getURIBuilder().setString('video_id',this.props.videoID).setString('video_container_id',this._domID).setInt('width',this.state.dimensions.x).setInt('height',this.state.dimensions.y).getURI();if(this.props.pageID)m=c('ActorURI').create(m,this.props.pageID);this.request=new (c('AsyncRequest'))().setMethod('GET').setURI(m).setReadOnly(true).setHandler(function(n){return this.setState({loading:false});}.bind(this)).send();},close:function(){if(!this.state.open)return;this.setState({open:false},function(){this.inform('close');});},_showForwardDialog:function(){this.setState({showForward:true});this.refs.forwardNUX.close();},_hideForwardDialog:function(){this.setState({showForward:false});},renderLayers:function(){if(this.props.disableForward)return {};var m=i._("Forward in separate messages"),n=c('CurrentEnvironment').messengerdotcom?c('MessengerForwardAttachmentDialog.react'):c('MessagingForwardAttachmentDialog.react');return {forwardDialog:c('React').createElement(n,{attachmentID:this.props.videoID,onClose:this._hideForwardDialog,shown:this.state.showForward,title:m}),forwardButtonNUX:c('React').createElement(c('MessagingForwardingButtonNUX.react'),{contextRef:function(){return this.refs.forwardButton;}.bind(this),ref:'forwardNUX'},i._("Send this video to other people in separate messages."))};},render:function(){var m=c('React').createElement('div',{className:"rfloat",id:this._domID}),n;if(!this.props.disableForward)n=c('React').createElement(c('SpotlightViewerBottomBarLink'),{onClick:this._showForwardDialog,ref:'forwardButton'},i._("Forward"));return (c('React').createElement(c('SpotlightViewer'),{onHide:this.close,open:this.state.open,rootClassName:this.props.rootClassName},c('React').createElement(c('SpotlightViewport'),{active:true,className:"_39hc",media:m,showLoadingIndicator:this.state.loading,stageDimensions:this.state.dimensions,useWidth:true},c('React').createElement(c('SpotlightViewerClose'),{onClick:this.close}),c('React').createElement(c('SpotlightViewerBottomBar'),{className:"stat_elem"},c('React').createElement(c('SpotlightViewerBottomBarGroup'),null),c('React').createElement(c('SpotlightViewerBottomBarGroup'),null,n,c('React').createElement(c('SpotlightViewerBottomBarLink'),{s:'true',href:this.props.videoURI},i._("Download")))))));}});f.exports=l;},null);