/*!CK:950277281!*//*1459228173,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["DC+fa"]); }

__d('MercuryRTCShareAttachment.react',['cx','fbt','Bootloader','FBRTCSupport','Image.react','React','MercuryShareAttachmentReactShape','MercuryShareAttachmentRenderLocations','MercuryViewer','MercuryParticipants','MercuryIDs','MercuryTimestamp','MNRTCCallabilityStore','SimpleXUIDialog','XUIText.react','XUIButton.react','CenteredContainer.react'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=c('MercuryShareAttachmentRenderLocations').CHAT,l=c('MercuryShareAttachmentRenderLocations').MESSENGER,m=c('MercuryShareAttachmentRenderLocations').WEB_INBOX,n=c('React').createClass({displayName:'MercuryRTCShareAttachment',propTypes:{attachment:c('MercuryShareAttachmentReactShape'),location:j.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),rootClassName:j.string},render:function(){var o=this.props.attachment.log_message_data.caller,p=this.props.attachment.log_message_data.callee,q=this.props.attachment.log_message_data.answered,r=o===c('MercuryViewer').getID(),s=r?p:o,t;c('MercuryParticipants').get(s,function(u){var v=c('MercuryIDs').getUserIDFromParticipantID(u.id),w=u.short_name?u.short_name:u.name,x=c('MercuryTimestamp').getPreciseTimestamp(this.props.attachment.timestamp),y=this._generateCallMessage(q,r,w),z=this._generateCallInformation(r,x),aa,ba;if(this.props.location===k){aa=this._generateCallActionLink(v,w,q,r);t=c('React').createElement('div',{className:"_1k2i"},c('React').createElement('div',{className:!q?"_1k2j":''},c('React').createElement(c('XUIText.react'),{weight:'bold'},y),c('React').createElement(c('XUIText.react'),{weight:'bold'},z)),c('React').createElement('hr',null),c('React').createElement(c('CenteredContainer.react'),{vertical:true,className:"_3-8x"},aa));}else if(this.props.location===l){aa=this._generateCallActionLink(v,w,q,r);t=c('React').createElement('div',{className:"_55q _5i_d _52mr"},c('React').createElement('div',{className:(!q?"_1k2j":'')+(' '+"_55r")},c('React').createElement(c('XUIText.react'),{weight:'bold'},y),c('React').createElement(c('XUIText.react'),{weight:'bold'},z)),c('React').createElement(c('CenteredContainer.react'),{vertical:true,className:"_3-8w"},aa));}else if(this.props.location===m){ba=this._generateCallActionButton(v,w,q,r);t=c('React').createElement('div',null,c('React').createElement('div',{className:(!q?"_1k2j":'')+(' '+"_55s")},y),c('React').createElement('div',{className:"_55t"},ba));}}.bind(this));return t;},_generateCallMessage:function(o,p,q){if(o){if(p){return i._("You called {firstname}.",[i.param('firstname',q)]);}else return i._("{firstname} called you.",[i.param('firstname',q)]);}else if(p){return i._("{firstname} missed a call from you.",[i.param('firstname',q)]);}else return i._("You missed a call from {firstname}.",[i.param('firstname',q)]);},_generateCallInformation:function(o,p){var q='/images/mercury/clients/messenger/admin_texts/';if(o){q+='adminTextOutgoingCall.png';}else q+='adminTextIncomingCall.png';return (c('React').createElement('div',{className:"_2phz"},c('React').createElement(c('Image.react'),{src:q,className:"_2pih"}),c('React').createElement('span',null,p)));},_generateCallActionLink:function(o,p,q,r){if(c('FBRTCSupport').isOSSupported()){return (c('React').createElement('a',{onClick:this._handleClick.bind(this,o,p)},!q&&!r?i._("Call Back"):i._("Call Again")));}else return (c('React').createElement('span',null,!q&&!r?i._("Call Back"):i._("Call Again")));},_generateCallActionButton:function(o,p,q,r){var s=!q&&!r?i._("Call Back"):i._("Call Again");return (c('React').createElement(c('XUIButton.react'),{onClick:this._handleClick.bind(this,o,p),label:s}));},_handleClick:function(o,p){c('Bootloader').loadModules(["FBRTCCore","FBRTCLogger"],function(q,r){if(q.isAvailableForWebrtcCalling(o)||c('MNRTCCallabilityStore').isCallable(o)){q.startOutgoingCall(o,r.Trigger.ADMIN_MESSAGE,false);}else c('SimpleXUIDialog').show(i._("{firstname} can't be called because they are temporarily offline.",[i.param('firstname',p)]),i._("Can't Connect Call"));});}});f.exports=n;},null);